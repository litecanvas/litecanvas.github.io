(()=>{(()=>{var et=new AudioContext,nt=(D=1,I=.05,j=220,N=0,Y=0,Q=.1,H=0,u=1,st=0,B=0,P=0,E=0,n=0,x=0,f=0,m=0,o=0,O=1,A=0,L=0,w=0)=>{let d=Math,b=2*d.PI,_=44100,F=st*=500*b/_/_,V=j*=(1-I+2*I*d.random(I=[]))*b/_,k=0,$=0,C=0,ot=1,p=0,dt=0,W=0,q=w<0?-1:1,rt=b*q*w*2/_,ht=d.cos(rt),at=d.sin,r=at(rt)/4,s=1+r,h=-2*ht/s,c=(1-r)/s,g=(1+q*ht)/2/s,v=-(q+ht)/s,X=g,K=0,T=0,M=0,S=0;for(N=_*N+9,A*=_,Y*=_,Q*=_,o*=_,B*=500*b/_**3,f*=b/_,P*=b/_,E*=_,n=_*n|0,D*=.3*(globalThis.zzfxV||1),q=N+A+Y+Q+o|0;C<q;I[C++]=W*D)++dt%(100*m|0)||(W=H?1<H?2<H?3<H?at(k*k):d.max(d.min(d.tan(k),1),-1):1-(2*k/b%2+2)%2:1-4*d.abs(d.round(k/b)-k/b):at(k),W=(n?1-L+L*at(b*C/n):1)*(W<0?-1:1)*d.abs(W)**u*(C<N?C/N:C<N+A?1-(C-N)/A*(1-O):C<N+A+Y?O:C<q-o?(q-C-o)/Q*O:0),W=o?W/2+(o>C?0:(C<q-o?1:(q-C)/o)*I[C-o|0]/2/D):W,w&&(W=S=X*K+v*(K=T)+g*(T=W)-c*M-h*(M=S))),rt=(j+=st+=B)*d.cos(f*$++),k+=rt+rt*x*at(C**5),ot&&++ot>E&&(j+=P,V+=P,ot=0),!n||++p%n||(j=V,st=F,ot=ot||1);D=et.createBuffer(1,q,_),D.getChannelData(0).set(I),j=et.createBufferSource(),j.buffer=D,j.connect(et.destination),j.start()},ct=["#111","#6a7799","#aec2c2","#FFF1E8","#e83b3b","#fabc20","#155fd9","#3cbcfc","#327345","#63c64d","#6c2c1f","#ac7c00"],i=(D,I="Assertion failed")=>{if(!D)throw new Error(I)};function z(D={}){let I=globalThis,j=Math.PI,N=j*2,Y=requestAnimationFrame,Q=[],H=(r,s,h)=>{r.addEventListener(s,h,!1),Q.push(()=>r.removeEventListener(s,h,!1))},u=Number.isFinite;D=Object.assign({fps:60,fullscreen:!0,width:null,height:null,autoscale:!0,pixelart:!1,antialias:!1,canvas:null,global:!0,loop:null,pauseOnBlur:!0,tapEvents:!0,keyboardEvents:!0,animate:!0},D);let B=!1,P=[],E=D.canvas||document.createElement("canvas"),n=D.fullscreen,x=D.autoscale,f=D.animate,m=1,o,O=.5,A=1,L,w,d,b=0,_=!0,F="sans-serif",V=32,k=Date.now(),$=D.global,C={init:null,update:null,draw:null,resized:null,tap:null,untap:null,tapping:null,tapped:null},ot={settings:Object.assign({},D),colors:ct},p={WIDTH:D.width,HEIGHT:D.height||D.width,CANVAS:null,ELAPSED:0,CENTERX:0,CENTERY:0,MOUSEX:-1,MOUSEY:-1,DEFAULT_SFX:[.5,,1675,,.06,.2,1,1.8,,,637,.06],PI:j,TWO_PI:N,HALF_PI:j*.5,lerp:(r,s,h)=>(i(u(r),"lerp: 1st param must be a number"),i(u(s),"lerp: 2nd param must be a number"),i(u(h),"lerp: 3rd param must be a number"),r+h*(s-r)),deg2rad:r=>(i(u(r),"deg2rad: 1st param must be a number"),j/180*r),rad2deg:r=>(i(u(r),"rad2deg: 1st param must be a number"),180/j*r),clamp:(r,s,h)=>(i(u(r),"clamp: 1st param must be a number"),i(u(s),"clamp: 2nd param must be a number"),i(u(h),"clamp: 3rd param must be a number"),r<s?s:r>h?h:r),wrap:(r,s,h)=>(i(u(r),"wrap: 1st param must be a number"),i(u(s),"wrap: 2nd param must be a number"),i(u(h),"wrap: 3rd param must be a number"),r-(h-s)*Math.floor((r-s)/(h-s))),map(r,s,h,c,g,v){i(u(r),"map: 1st param must be a number"),i(u(s),"map: 2nd param must be a number"),i(u(h),"map: 3rd param must be a number"),i(u(c),"map: 4th param must be a number"),i(u(g),"map: 5th param must be a number");let X=(r-s)/(h-s)*(g-c)+c;return v?p.clamp(X,c,g):X},norm:(r,s,h)=>(i(u(r),"norm: 1st param must be a number"),i(u(s),"norm: 2nd param must be a number"),i(u(h),"norm: 3rd param must be a number"),p.map(r,s,h,0,1)),rand:(r=0,s=1)=>{i(u(r),"rand: 1st param must be a number"),i(u(s),"rand: 2nd param must be a number");let h=1664525,c=1013904223,g=4294967296;return k=(h*k+c)%g,k/g*(s-r)+r},randi:(r=0,s=1)=>(i(u(r),"randi: 1st param must be a number"),i(u(s),"randi: 2nd param must be a number"),Math.floor(p.rand(r,s+1))),seed:r=>(i(r==null||u(r),"seed: 1st param must be a number"),r==null?k:k=~~r),cls(r){i(r==null||u(r)&&r>=0,"cls: 1st param must be a number");let s=o.canvas.width,h=o.canvas.height;r==null?o.clearRect(0,0,s,h):p.rectfill(0,0,s,h,r)},rect(r,s,h,c,g,v=null){i(u(r),"rect: 1st param must be a number"),i(u(s),"rect: 2nd param must be a number"),i(u(h)&&h>0,"rect: 3rd param must be a positive number"),i(u(c)&&c>=0,"rect: 4th param must be a positive number or zero"),i(g==null||u(g)&&g>=0,"rect: 5th param must be a positive number or zero"),i(v==null||u(v)||Array.isArray(v)&&v.length>=1,"rect: 6th param must be a number or array of numbers"),o.beginPath(),o[v?"roundRect":"rect"](~~r-O,~~s-O,~~h+O*2,~~c+O*2,v),p.stroke(g)},rectfill(r,s,h,c,g,v=null){i(u(r),"rectfill: 1st param must be a number"),i(u(s),"rectfill: 2nd param must be a number"),i(u(h)&&h>=0,"rectfill: 3rd param must be a positive number or zero"),i(u(c)&&c>=0,"rectfill: 4th param must be a positive number or zero"),i(g==null||u(g)&&g>=0,"rectfill: 5th param must be a positive number or zero"),i(v==null||u(v)||Array.isArray(v)&&v.length>=1,"rectfill: 6th param must be a number or array of at least 2 numbers"),o.beginPath(),o[v?"roundRect":"rect"](~~r,~~s,~~h,~~c,v),p.fill(g)},circ(r,s,h,c){i(u(r),"circ: 1st param must be a number"),i(u(s),"circ: 2nd param must be a number"),i(u(h)&&h>=0,"circ: 3rd param must be a positive number or zero"),i(c==null||u(c)&&c>=0,"circ: 4th param must be a positive number or zero"),o.beginPath(),o.arc(~~r,~~s,~~h,0,N),p.stroke(c)},circfill(r,s,h,c){i(u(r),"circfill: 1st param must be a number"),i(u(s),"circfill: 2nd param must be a number"),i(u(h)&&h>=0,"circfill: 3rd param must be a positive number or zero"),i(c==null||u(c)&&c>=0,"circfill: 4th param must be a positive number or zero"),o.beginPath(),o.arc(~~r,~~s,~~h,0,N),p.fill(c)},line(r,s,h,c,g){i(u(r),"line: 1st param must be a number"),i(u(s),"line: 2nd param must be a number"),i(u(h),"line: 3rd param must be a positive number or zero"),i(u(c),"line: 4th param must be a positive number or zero"),i(g==null||u(g)&&g>=0,"line: 5th param must be a positive number or zero"),o.beginPath();let v=O!==0&&~~r===~~h?.5:0,X=O!==0&&~~s===~~c?.5:0;o.moveTo(~~r+v,~~s+X),o.lineTo(~~h+v,~~c+X),p.stroke(g)},linewidth(r){i(u(r)&&~~r>0,"linewidth: 1st param must be a positive number"),o.lineWidth=~~r,O=~~r%2===0?0:.5},linedash(r,s=0){i(Array.isArray(r)&&r.length>0,"linedash: 1st param must be an array of numbers"),i(u(s),"linedash: 2nd param must be a number"),o.setLineDash(r),o.lineDashOffset=s},text(r,s,h,c=3,g="normal"){i(u(r),"text: 1st param must be a number"),i(u(s),"text: 2nd param must be a number"),i(c==null||u(c)&&c>=0,"text: 4th param must be a positive number or zero"),i(typeof g=="string","text: 5th param must be a string"),o.font=`${g} ${V}px ${F}`,o.fillStyle=p.getcolor(c),o.fillText(h,~~r,~~s)},textfont(r){i(typeof r=="string","textfont: 1st param must be a string"),F=r},textsize(r){i(u(r),"textsize: 1st param must be a number"),V=r},textalign(r,s){i(r==null||typeof r=="string","textalign: 1st param must be a string"),i(s==null||typeof s=="string","textalign: 2nd param must be a string"),r&&(o.textAlign=r),s&&(o.textBaseline=s)},image(r,s,h){i(u(r),"image: 1st param must be a number"),i(u(s),"image: 2nd param must be a number"),o.drawImage(h,~~r,~~s)},paint(r,s,h,c={}){i(u(r),"paint: 1st param must be a number"),i(u(s),"paint: 2nd param must be a number"),i(typeof h=="function"||Array.isArray(h),"paint: 3rd param must be a function or array"),i(c&&!c.scale||u(c.scale),"paint: 4th param (options.scale) must be a number");let g=c.canvas||new OffscreenCanvas(1,1),v=c.scale||1,X=o;if(g.width=r*v,g.height=s*v,o=g.getContext("2d"),o.scale(v,v),h.push){let K=0,T=0;o.imageSmoothingEnabled=!1;for(let M of h){for(let S of M)S!==" "&&S!=="."&&p.rectfill(K,T,1,1,parseInt(S,16)),K++;T++,K=0}}else h(o);return o=X,g},ctx(r){return r&&(o=r),o},push:()=>o.save(),pop:()=>o.restore(),translate:(r,s)=>(i(u(r),"translate: 1st param must be a number"),i(u(s),"translate: 2nd param must be a number"),o.translate(~~r,~~s)),scale:(r,s)=>(i(u(r),"scale: 1st param must be a number"),i(s==null||u(s),"scale: 2nd param must be a number"),o.scale(r,s||r)),rotate:r=>(i(u(r),"rotate: 1st param must be a number"),o.rotate(r)),alpha(r){i(u(r),"alpha: 1st param must be a number"),o.globalAlpha=p.clamp(r,0,1)},path:r=>(i(r==null||typeof r=="string"||r instanceof Path2D,"path: 1st param must be a string or a Path2D instance"),new Path2D(r)),fill(r,s){i(r==null||u(r)&&r>=0,"fill: 1st param must be a positive number or zero"),i(s==null||s instanceof Path2D,"fill: 2nd param must be a Path2D instance"),o.fillStyle=p.getcolor(r),s?o.fill(s):o.fill()},stroke(r,s){i(r==null||u(r)&&r>=0,"stroke: 1st param must be a positive number or zero"),i(s==null||s instanceof Path2D,"stroke: 2nd param must be a Path2D instance"),o.strokeStyle=p.getcolor(r),s?o.stroke(s):o.stroke()},clip(r){i(r instanceof Path2D,"clip: 1st param must be a Path2D instance"),o.clip(r)},sfx(r,s=0,h=1){return i(r==null||Array.isArray(r),"sfx: 1st param must be an array"),i(u(s),"sfx: 2nd param must be a number"),i(u(h),"sfx: 3rd param must be a number"),I.zzfxV<=0||navigator.userActivation&&!navigator.userActivation.hasBeenActive?!1:(r=r||p.DEFAULT_SFX,(s>0||h!==1)&&(r=r.slice(),r[0]=h*(r[0]||1),r[10]=~~r[10]+s),nt.apply(0,r),r)},volume(r){i(u(r),"volume: 1st param must be a number"),I.zzfxV=r},colrect:(r,s,h,c,g,v,X,K)=>(i(u(r),"colrect: 1st param must be a number"),i(u(s),"colrect: 2nd param must be a number"),i(u(h),"colrect: 3rd param must be a number"),i(u(c),"colrect: 4th param must be a number"),i(u(g),"colrect: 5th param must be a number"),i(u(v),"colrect: 6th param must be a number"),i(u(X),"colrect: 7th param must be a number"),i(u(K),"colrect: 8th param must be a number"),r<g+X&&r+h>g&&s<v+K&&s+c>v),colcirc:(r,s,h,c,g,v)=>(i(u(r),"colcirc: 1st param must be a number"),i(u(s),"colcirc: 2nd param must be a number"),i(u(h),"colcirc: 3rd param must be a number"),i(u(c),"colcirc: 4th param must be a number"),i(u(g),"colcirc: 5th param must be a number"),i(u(v),"colcirc: 6th param must be a number"),(c-r)**2+(g-s)**2<=(h+v)**2),use(r,s={}){i(typeof r=="function","use: 1st param must be a function"),i(typeof s=="object","use: 2nd param must be an object"),B?at(r,s):P.push([r,s])},listen(r,s){return i(typeof r=="string","listen: 1st param must be a string"),i(typeof s=="function","listen: 2nd param must be a function"),C[r]=C[r]||new Set,C[r].add(s),()=>C[r].delete(s)},emit(r,s,h,c,g){i(typeof r=="string","emit: 1st param must be a string"),ht("before:"+r,s,h,c,g),ht(r,s,h,c,g),ht("after:"+r,s,h,c,g)},getcolor:r=>(i(r==null||u(r)&&r>=0,"getcolor: 1st param must be a number"),ct[~~r%ct.length]),setvar(r,s){i(typeof r=="string","setvar: 1st param must be a string"),s==null&&console.warn(`setvar: key "${r}" was defined as ${s}`),p[r]=s,$&&(I[r]=s)},resize(r,s){i(u(r),"resize: 1st param must be a number"),i(u(s),"resize: 2nd param must be a number"),p.setvar("WIDTH",E.width=r),p.setvar("HEIGHT",E.height=s),rt()},timescale(r){i(u(r),"timescale: 1st param must be a number"),A=r},setfps(r){i(u(r)&&r>0,"setfps: 1st param must be a positive number"),w=1/r,d=w*1e3,b=0},quit(){p.emit("quit");for(let r of Q)r();if(_=C=!1,$){for(let r in p)delete I[r];delete I.__litecanvas}}};for(let r of["sin","cos","atan2","hypot","tan","abs","ceil","round","floor","trunc","min","max","pow","sqrt","sign","exp"])p[r]=Math[r];function dt(){B=!0;let r=D.loop?D.loop:I;for(let s in C)r[s]&&p.listen(s,r[s]);for(let[s,h]of P)at(s,h);if((n||x)&&H(I,"resize",rt),rt(),D.tapEvents){let s=(T,M)=>[(T-E.offsetLeft)/m,(M-E.offsetTop)/m],h=new Map,c=(T,M,S)=>{let R={x:M,y:S,startX:M,startY:S,ts:performance.now()};return h.set(T,R),R},g=(T,M,S)=>{let R=h.get(T)||c(T);R.x=M,R.y=S},v=T=>T&&performance.now()-T.ts<=200,X=!1;H(E,"mousedown",T=>{T.preventDefault();let[M,S]=s(T.pageX,T.pageY);p.emit("tap",M,S,0),c(0,M,S),X=!0}),H(E,"mousemove",T=>{T.preventDefault();let[M,S]=s(T.pageX,T.pageY);p.setvar("MOUSEX",M),p.setvar("MOUSEY",S),X&&(p.emit("tapping",M,S,0),g(0,M,S))}),H(E,"mouseup",T=>{T.preventDefault();let M=h.get(0),[S,R]=s(T.pageX,T.pageY);v(M)&&p.emit("tapped",M.startX,M.startY,0),p.emit("untap",S,R,0),h.delete(0),X=!1}),H(E,"touchstart",T=>{T.preventDefault();let M=T.changedTouches;for(let S of M){let[R,bt]=s(S.pageX,S.pageY);p.emit("tap",R,bt,S.identifier+1),c(S.identifier+1,R,bt)}}),H(E,"touchmove",T=>{T.preventDefault();let M=T.changedTouches;for(let S of M){let[R,bt]=s(S.pageX,S.pageY);p.emit("tapping",R,bt,S.identifier+1),g(S.identifier+1,R,bt)}});let K=T=>{T.preventDefault();let M=[];if(T.targetTouches.length>0)for(let S of T.targetTouches)M.push(S.identifier+1);for(let[S,R]of h)M.includes(S)||(v(R)&&p.emit("tapped",R.startX,R.startY,S),p.emit("untap",R.x,R.y,S),h.delete(S))};H(E,"touchend",K),H(E,"touchcancel",K),H(I,"blur",()=>{X=!1;for(let[T,M]of h)p.emit("untap",M.x,M.y,T),h.delete(T)})}if(D.keyboardEvents){let s=new Set,h=c=>(i(typeof c=="string","iskeydown: 1st param must be a string"),c==="any"?s.size>0:s.has(c.toLowerCase()));p.setvar("iskeydown",h),H(I,"keydown",c=>{s.add(c.key.toLowerCase())}),H(I,"keyup",c=>{s.delete(c.key.toLowerCase())}),H(I,"blur",()=>s.clear())}D.pauseOnBlur&&(H(I,"blur",()=>{_=!1}),H(I,"focus",()=>{_=!0,Y(W)})),p.setfps(D.fps),p.emit("init",p),L=performance.now(),Y(W)}function W(r){let s=!f,h=r-L;for(b+=h>100?d:h,L=r;b>=d;)p.emit("update",w*A),p.setvar("ELAPSED",p.ELAPSED+w*A),b-=d,s=!0;s&&(p.textalign("start","top"),p.emit("draw")),_&&f&&Y(W)}function q(){E=typeof E=="string"?document.querySelector(E):E,p.setvar("CANVAS",E),o=E.getContext("2d"),H(E,"click",()=>I.focus()),p.WIDTH>0&&(n=!1),E.style="",E.width=p.WIDTH,E.height=p.HEIGHT||p.WIDTH,E.parentNode||document.body.appendChild(E)}function rt(){let r=I.innerWidth,s=I.innerHeight,h=E.style;h.display="block",n?(h.position="absolute",h.inset=0,p.setvar("WIDTH",E.width=r),p.setvar("HEIGHT",E.height=s)):x&&(h.margin="auto",m=Math.min(r/p.WIDTH,s/p.HEIGHT),m=(D.pixelart?~~m:m)||1,h.width=p.WIDTH*m+"px",h.height=p.HEIGHT*m+"px"),p.setvar("CENTERX",p.WIDTH/2),p.setvar("CENTERY",p.HEIGHT/2),(!D.antialias||D.pixelart)&&(o.imageSmoothingEnabled=!1,E.style.imageRendering="pixelated"),p.emit("resized",m),f||Y(W)}function ht(r,s,h,c,g){if(C[r])for(let v of C[r])v(s,h,c,g)}function at(r,s){let h=r(p,ot,s);if(typeof h=="object")for(let c of Object.keys(h))p.setvar(c,h[c])}if($){if(I.__litecanvas)throw"global litecanvas already instantiated";Object.assign(I,p),I.__litecanvas=p}return q(),document.readyState==="loading"?H(I,"DOMContentLoaded",()=>Y(dt)):Y(dt),p}globalThis.litecanvas=z})();(()=>{var et=Object.defineProperty,nt=(t,e)=>{for(var a in e)et(t,a,{get:e[a],enumerable:!0})};globalThis.utils=globalThis.utils||{},globalThis.utils.global=()=>{for(let t in globalThis.utils)t!=="global"&&(globalThis[t]=globalThis.utils[t])};var ct={};nt(ct,{ANCHOR_BOT_LEFT:()=>R,ANCHOR_BOT_RIGHT:()=>bt,ANCHOR_CENTER:()=>T,ANCHOR_TOP_LEFT:()=>M,ANCHOR_TOP_RIGHT:()=>S,Actor:()=>Dt,BACK_IN:()=>Nt,BACK_IN_OUT:()=>Wt,BACK_OUT:()=>Yt,BOUNCE_IN:()=>St,BOUNCE_IN_OUT:()=>Vt,BOUNCE_OUT:()=>wt,Camera:()=>D,DOWN:()=>X,EASE_IN:()=>Ft,EASE_IN_OUT:()=>jt,EASE_OUT:()=>Xt,ELASTIC_IN:()=>zt,ELASTIC_IN_OUT:()=>Gt,ELASTIC_OUT:()=>Bt,Grid:()=>I,LEFT:()=>K,LINEAR:()=>vt,Noise:()=>Kt,ONE:()=>c,RIGHT:()=>v,TypedGrid:()=>j,UP:()=>g,Vector:()=>st,ZERO:()=>h,advance:()=>kt,diff:()=>Ct,flipImage:()=>Qt,fract:()=>Ht,intersection:()=>i,mod:()=>Rt,range:()=>Pt,resolve:()=>z,scaleImage:()=>Zt,tint:()=>Jt,tween:()=>Ut,vec:()=>P,vecAbs:()=>W,vecAdd:()=>x,vecAngle:()=>k,vecAngleBetween:()=>$,vecCeil:()=>q,vecClamp:()=>at,vecCross:()=>ot,vecDist:()=>F,vecDist2:()=>V,vecDiv:()=>o,vecDot:()=>C,vecEq:()=>E,vecFloor:()=>rt,vecIsZero:()=>s,vecLerp:()=>p,vecLimit:()=>_,vecMag:()=>w,vecMag2:()=>d,vecMove:()=>r,vecMult:()=>m,vecNorm:()=>b,vecRand:()=>dt,vecReflect:()=>A,vecRotate:()=>O,vecRound:()=>ht,vecSet:()=>n,vecSetMag:()=>L,vecSub:()=>f,wave:()=>Lt});var i=(t,e,a,l,y,U,G,Z)=>{let it=Math.max(t,y),mt=Math.min(t+a,y+G)-it,pt=Math.max(e,U),gt=Math.min(e+l,U+Z)-pt;return[it,pt,mt,gt]},z=(t,e,a,l,y,U,G,Z)=>{let[it,mt,pt,gt]=i(t,e,a,l,y,U,G,Z),ft="",tt=t,J=e;return pt<gt?t<y?(ft="right",tt=y-a):(ft="left",tt=y+G):e<U?(ft="bottom",J=U-l):(ft="top",J=U+Z),{direction:ft,x:tt,y:J}},D=class{_engine=null;x=0;y=0;ox=0;oy=0;width=0;height=0;rotation=0;scale=1;_shake={x:0,y:0,removeListener:null};constructor(t=null,e=0,a=0,l=null,y=null){this._engine=t||globalThis,this.ox=e,this.oy=a,this.resize(l||this._engine.WIDTH-e,y||this._engine.HEIGHT-a),this.x=this.width/2,this.y=this.height/2}resize(t,e){this.width=t,this.height=e,this._engine.emit("camera-resized",this)}start(t=!1){if(this._engine.push(),t){let l=path();l.rect(this.ox,this.oy,this.width,this.height),this._engine.clip(l)}let e=this.ox+this.width/2,a=this.oy+this.height/2;this._engine.translate(e,a),this._engine.scale(this.scale),this._engine.rotate(this.rotation),this._engine.translate(-this.x+this._shake.x,-this.y+this._shake.y)}end(){this._engine.pop()}lookAt(t,e){this.x=t,this.y=e}move(t,e){this.x+=t,this.y+=e}zoom(t){this.scale*=t}zoomTo(t){this.scale=t}rotate(t){this.rotation+=t}rotateTo(t){this.rotation=t}getWorldPoint(t,e,a={}){let l=Math.cos(-this.rotation),y=Math.sin(-this.rotation);return t=(t-this.width/2-this.ox)/this.scale,e=(e-this.height/2-this.oy)/this.scale,a.x=l*t-y*e+this.x,a.y=y*t+l*e+this.y,a}getCameraPoint(t,e,a={}){let l=Math.cos(-this.rotation),y=Math.sin(-this.rotation);return t=t-this.x,e=e-this.y,t=l*t-y*e,e=y*t+l*e,a.x=t*this.scale+this.width/2+this.ox,a.y=e*this.scale+this.height/2+this.oy,a}getBounds(){return[this.ox,this.oy,this.width,this.height]}viewing(t,e,a,l){let y=this.width/2-this.x,U=this.height/2-this.y,G=this.width/this.scale,Z=this.height/this.scale;return this._engine.colrect(t,e,a,l,y,U,G,Z)}shake(t=1,e=.3){this.shaking||(this._shake.removeListener=this._engine.listen("update",a=>{this._shake.x=this._engine.randi(-t,t),this._shake.y=this._engine.randi(-t,t),e-=a,e<=0&&this.unshake()}))}unshake(){this.shaking&&(this._shake.removeListener(),this._shake.removeListener=null,this._shake.x=this._shake.y=0)}get shaking(){return this._shake.removeListener!==null}},I=class It{_w;_h;_c;constructor(e,a,l=[]){this._w=Math.max(1,~~e),this._h=Math.max(1,~~a),this._c=l}[Symbol.iterator](){let e=0;return{next:()=>({value:[this.indexToPointX(e),this.indexToPointY(e),this._c[e++]],done:e>this._c.length})}}clone(){return new It(this._w,this._h,this._c)}clear(){this.forEach((e,a)=>this.set(e,a,void 0))}get width(){return this._w}get height(){return this._h}set(e,a,l){this._c[this.pointToIndex(e,a)]=l}get(e,a){return this._c[this.pointToIndex(e,a)]}has(e,a){return this.get(e,a)!=null}check(e,a){return e>=0&&e<this._w&&a>=0&&a<this._h}get length(){return this._w*this._h}pointToIndex(e,a){return this.clampX(~~e)+this.clampY(~~a)*this._w}indexToPointX(e){return e%this._w}indexToPointY(e){return Math.floor(e/this._w)}forEach(e,a=!1){let l=a?this.length-1:0,y=a?-1:this.length,U=a?-1:1;for(;l!==y;){let G=this.indexToPointX(l),Z=this.indexToPointY(l),it=this._c[l];if(e(G,Z,it,this)===!1)break;l+=U}}fill(e){this.forEach((a,l)=>{this.set(a,l,e)})}clampX(e){return N(e,0,this._w-1)}clampY(e){return N(e,0,this._h-1)}toArray(){return this._c.slice()}toString(e=" ",a=!0){if(!a)return this._c.join(e);let l=[];return this.forEach((y,U,G)=>{l[U]=l[U]||"",l[U]+=G+e}),l.join(`
`)}},j=class Ot extends I{constructor(e,a,l=Uint8Array){super(e,a,null),this._c=new l(this._w*this._h)}has(e,a){return this.get(e,a)!==0}clone(){let e=new Ot(this._w,this._h,this._c.constructor);return this.forEach((a,l,y)=>{e.set(a,l,y)}),e}};function N(t,e,a){return t<e?e:t>a?a:t}var Y=Math.sqrt,Q=Math.cos,H=Math.sin,u=2*Math.PI,st=class{x;y;constructor(t=0,e=t){this.x=t,this.y=e}toString(){return`Vector (${this.x}, ${this.y})`}},B=t=>t instanceof st,P=(t=0,e=t)=>(B(t)&&(e=t.y,t=t.x),new st(t,e)),E=(t,e,a=e)=>B(e)?E(t,e.x,e.y):t.x===e&&t.y===a,n=(t,e,a=e)=>(B(e)?n(t,e.x,e.y):(t.x=e,t.y=a),t),x=(t,e,a=e)=>B(e)?x(t,e.x,e.y):(t.x+=e,t.y+=a,t),f=(t,e,a=e)=>B(e)?f(t,e.x,e.y):(t.x-=e,t.y-=a,t),m=(t,e,a=e)=>B(e)?m(t,e.x,e.y):(t.x*=e,t.y*=a,t),o=(t,e,a=e)=>B(e)?o(t,e.x,e.y):(t.x/=e||1,t.y/=a||1,t),O=(t,e)=>{let a=Q(e),l=H(e);return t.x=a*t.x-l*t.y,t.y=l*t.x+a*t.y,t},A=(t,e)=>{let a=b(P(e));return f(t,m(a,2*C(t,a)))},L=(t,e)=>(b(t),m(t,e),t),w=t=>Y(t.x*t.x+t.y*t.y),d=t=>t.x*t.x+t.y*t.y,b=t=>{let e=w(t);return e>0&&o(t,e),t},_=(t,e=1)=>{let a=d(t);return a>e*e&&(o(t,Y(a)),m(t,e)),t},F=(t,e)=>{let a=t.x-e.x,l=t.y-e.y;return Y(a*a+l*l)},V=(t,e)=>{let a=t.x-e.x,l=t.y-e.y;return a*a+l*l},k=t=>Math.atan2(t.y,t.x),$=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),C=(t,e)=>t.x*e.x+t.y*e.y,ot=(t,e)=>t.x*e.y-t.y*e.x,p=(t,e,a)=>(t.x+=(e.x-t.x)*a||0,t.y+=(e.y-t.y)*a||0,t),dt=(t=1,e=t,a=globalThis.rand||Math.random)=>{let l=a()*u,y=a()*(e-t)+t;return P(Q(l)*y,H(l)*y)},W=t=>(t.x=Math.abs(t.x),t.y=Math.abs(t.y),t),q=t=>(t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t),rt=t=>(t.x=Math.floor(t.x),t.y=Math.floor(t.y),t),ht=t=>(t.x=Math.round(t.x),t.y=Math.round(t.y),t),at=(t,e,a)=>(t.x<e.x&&(t.x=e.x),t.x>a.x&&(t.x=a.x),t.y<e.y&&(t.y=e.y),t.y>a.y&&(t.y=a.y),t),r=(t,e,a=1)=>x(t,e.x*a,e.y*a),s=t=>E(t,h),h=P(0,0),c=P(1,1),g=P(0,-1),v=P(1,0),X=P(0,1),K=P(-1,0),T=P(.5,.5),M=P(0,0),S=P(1,0),R=P(0,1),bt=P(1,1),Dt=class{sprite;pos;_o;_s;flipX=!1;flipY=!1;angle=0;opacity=1;hidden=!1;constructor(t,e,a=M){this.sprite=t,this.pos=e||P(0),this._o=P(a),this._s=P(1,1)}set x(t){this.pos.x=t}get x(){return this.pos.x}set y(t){this.pos.y=t}get y(){return this.pos.y}set anchor(t){this._o.x=t.x,this._o.y=t.y}get anchor(){return this._o}get width(){return this.sprite.width*this._s.x}get height(){return this.sprite.height*this._s.y}get scale(){return this._s}scaleTo(t,e=t){this._s.x=t,this._s.y=e}scaleBy(t,e=t){this._s.x*=t,this._s.y*=e}getBounds(t=!0){let e=this.sprite.width*(t?this._s.x:1),a=this.sprite.height*(t?this._s.y:1),l=this.pos.x-e*this.anchor.x,y=this.pos.y-a*this.anchor.y;return[l,y,e,a]}draw(t=globalThis,e=!0){this.hidden||this.opacity<=0||(e&&t.push(),this.transform(t),this.drawImage(t),e&&t.pop())}transform(t){t.translate(this.pos.x,this.pos.y),t.rotate(t.deg2rad(this.angle)),t.scale((this.flipX?-1:1)*this._s.x,(this.flipY?-1:1)*this._s.y)}drawImage(t,e=!0){let a=this.anchor,l=-this.sprite.width*(this.flipX?1-a.x:a.x),y=-this.sprite.height*(this.flipY?1-a.y:a.y);e&&t.alpha(this.opacity),t.image(l,y,this.sprite)}},Ct=(t,e)=>Math.abs(e-t)||0,Lt=(t,e,a,l=Math.sin)=>t+(l(a)+1)/2*(e-t),Ht=t=>t%1||0,Pt=t=>Array.from(Array(t).keys()),kt=advance=(t,e,a,l=1)=>{a&&(e.x+=a.x*l,e.y+=a.y*l),t.x+=e.x*l,t.y+=e.y*l},Rt=(t,e)=>(e+t%e)%e,_t=Math.PI/2,Ut=(t,e,a,l=1,y=vt)=>new $t(t,e,a,l,y),vt=t=>t,Ft=t=>t*t,Xt=t=>-t*(t-2),jt=t=>t<.5?2*t*t:-2*t*t+4*t-1,Nt=t=>t*t*t-t*Math.sin(t*Math.PI),Yt=t=>{let e=1-t;return 1-(e*e*e-e*Math.sin(e*Math.PI))},Wt=t=>{if(t<.5){let a=2*t;return .5*(a*a*a-a*Math.sin(a*Math.PI))}let e=1-(2*t-1);return .5*(1-(e*e*e-e*Math.sin(t*Math.PI)))+.5},zt=t=>Math.sin(13*_t*t)*Math.pow(2,10*(t-1)),Bt=t=>Math.sin(-13*_t*(t+1))*Math.pow(2,-10*t)+1,Gt=t=>{if(t<.5){let l=Math.sin(13*_t*(2*t)),y=Math.pow(2,10*(2*t-1));return .5*l*y}let e=Math.sin(-13*_t*(2*t-1+1)),a=Math.pow(2,-10*(2*t-1));return .5*(e*a+2)},St=t=>1-wt(1-t),wt=t=>t<4/11?121*t*t/16:t<8/11?363/40*t*t-99/10*t+17/5:t<9/10?4356/361*t*t-35442/1805*t+16061/1805:54/5*t*t-513/25*t+268/25,Vt=t=>t<.5?.5*St(t*2):.5*wt(t*2-1)+.5,$t=class{running=!1;_o;_p;_x;_d;_w;_e;_rel;_cb=[];_t=0;_u=0;_ch=this;_cu=this;_lc;constructor(t,e,a,l,y){this._o=t,this._p=e,this._x=a,this._d=l,this._e=y,this._w=0}start(t){if(this.running)return this;this._cu.stop(!1),this._ch=this._cu=this,this.running=!0;let e=this._o[this._p]||0,a=this._rel?e+this._x:this._x;return this._lc=this._lc||t||globalThis,this._u=this._lc.listen("update",l=>{if(this._t<=this._w){this._t+=l;return}let y=this._t-this._w;this._o[this._p]=this._lc.lerp(e,a,this._e(y/this._d)),this._t+=l,y>=this._d&&(this._o[this._p]=a,this.stop())}),this}stop(t=!0){if(!this._u)return this;if(this.running=!1,this._u(),this._t=0,t)for(let e of this._cb)e(this._o);return this}restart(t=null,e=!1){return this.stop(e).restart(t)}onEnd(t){return this._cb.push(t),this}chain(t){return this._ch.onEnd(()=>{this._cu=t.start(this._lc)}),this._ch=t,this}reset(){return this._cb.length=0,this.stop()}relative(t=!0){return this._rel=t,this}delay(t){return this._w=t,this}get current(){return this._cu}get progress(){return this.running&&this._t>this._w?(this._t-this._w)/this._d:0}},Et=4,yt=1<<Et,At=8,qt=1<<At,ut=4095,Tt=t=>.5*(1-Math.cos(t*Math.PI)),Kt=class{_p=[];_po=4;_pf=.5;_e=null;constructor(t){this._e=t||globalThis,this.noiseSeed()}noise(t,e=0,a=0){t<0&&(t=-t),e<0&&(e=-e),a<0&&(a=-a);let l=Math.floor(t),y=Math.floor(e),U=Math.floor(a),G=t-l,Z=e-y,it=a-U,mt,pt,gt=0,ft=.5,tt,J,xt;for(let Mt=0;Mt<this._po;Mt++){let lt=l+(y<<Et)+(U<<At);mt=Tt(G),pt=Tt(Z),tt=this._p[lt&ut],tt+=mt*(this._p[lt+1&ut]-tt),J=this._p[lt+yt&ut],J+=mt*(this._p[lt+yt+1&ut]-J),tt+=pt*(J-tt),lt+=qt,J=this._p[lt&ut],J+=mt*(this._p[lt+1&ut]-J),xt=this._p[lt+yt&ut],xt+=mt*(this._p[lt+yt+1&ut]-xt),J+=pt*(xt-J),tt+=Tt(it)*(J-tt),gt+=tt*ft,ft*=this._pf,l<<=1,G*=2,y<<=1,Z*=2,U<<=1,it*=2,G>=1&&(l++,G--),Z>=1&&(y++,Z--),it>=1&&(U++,it--)}return gt}noiseDetail(t,e){t>0&&(this._po=t),e>0&&(this._pf=e)}noiseSeed(t=null){t!=null&&this._e.seed(t);let e=this._e.rand||Math.random;for(let a=0;a<ut+1;a++)this._p[a]=e()}},Jt=(t,e,a=1,l=globalThis)=>l.paint(t.width,t.height,y=>{l.push(),l.alpha(a),l.rectfill(0,0,t.width,t.height,e),y.globalCompositeOperation="destination-atop",l.alpha(1),l.image(0,0,t),l.pop()}),Zt=(t,e,a=!0,l=globalThis)=>l.paint(t.width*e,t.height*e,y=>{l.push(),y.imageSmoothingEnabled=!a,l.scale(e),l.image(0,0,t),l.pop()}),Qt=(t,e=!0,a=!1,l=globalThis)=>l.paint(t.width,t.height,y=>{l.push(),l.scale(e?-1:1,a?-1:1),l.image(e?-t.width:0,a?-t.height:0,t),l.pop()});globalThis.utils=Object.assign(globalThis.utils||{},ct)})();(()=>{function et(n){return n.split("\\").pop().split("/").pop().split(".")[0]}function nt(n,x){return x&&!ct(n)&&(n=x+n),n}function ct(n){try{return!!new URL(n).protocol}catch{}return!1}var i={crossOrigin:"anonymous",baseURL:null,allowSoundInterruptions:!0,ignoreErrors:!1},z=(n,x)=>{let f="LOADING";n.setvar(f,~~n[f]+~~x)};function D(n,x,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.font={},{loadFont:async(m,o,O)=>{let{baseURL:A,ignoreErrors:L}=f,w=et(o);o=nt(o,A);let d=new FontFace(m,`url(${o})`),b={asset:d,type:"font",fontName:m,src:o,id:w};n.emit("filter-asset",d,b),document.fonts.add(d),z(n,1);let _=d.load();return _.then(F=>{ASSETS.font[w]=F,O&&O(F),n.emit("asset-load",b),z(n,-1)}).catch(F=>{if(console.error(F),!L)throw new Error("Failed to load font from "+o);O&&O(),n.emit("asset-error",b)}),_}}}function I(n,{colors:x},f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.image={},{loadImage:async(m,o)=>{let{baseURL:O,ignoreErrors:A,crossOrigin:L}=f,w={splitFrames:j,convertColors:N(x)},d=et(m);m=nt(m,O);let b=new Image,_={asset:b,type:"image",src:m,id:d};return new Promise(F=>{z(n,1),b.crossOrigin=L,b.onerror=V=>{console.error(V);let k="Failed to load image from "+m;if(!A)throw new Error(k);o&&o(),n.emit("asset-error",_)},b.onload=()=>{n.ASSETS.image[d]=b,o&&o(b,w),n.emit("asset-load",_),z(n,-1),F(b)},n.emit("filter-asset",b,_),b.src=m})}}}function j(n,x,f,m=0,o=0){let O=[],A=Math.floor((n.width+o)/(x+o)),L=Math.floor((n.height+o)/(f+o));for(let w=0;w<L;w++)for(let d=0;d<A;d++){let b=new OffscreenCanvas(x,f);b.getContext("2d").drawImage(n,m+d*x+d*o,m+w*f+w*o,x,f,0,0,x,f),O.push(b)}return O}function N(n){return(x,f=!1)=>{let m=new OffscreenCanvas(x.width,x.height),o=m.getContext("2d");o.drawImage(x,0,0);let O=o.getImageData(0,0,x.width,x.height),A=O.data,L=new Map;for(let w=0,d=A.length;w<d;w+=4){let b=A[w],_=A[w+1],F=A[w+2],V=[b,_,F],k=V.join(","),$=L.get(k);$||($=H(V,n),L.set(k,$));let C=$.startsWith("#")?Y($):Q($);A[w]=C[0],A[w+1]=C[1],A[w+2]=C[2],A[w+3]=f?A[w+3]:255}return o.putImageData(O,0,0),m}}function Y(n){let x=0,f=0,m=0;return n.length===4?(x="0x"+n[1]+n[1],f="0x"+n[2]+n[2],m="0x"+n[3]+n[3]):n.length===7&&(x="0x"+n[1]+n[2],f="0x"+n[3]+n[4],m="0x"+n[5]+n[6]),[~~x,~~f,~~m]}function Q(n){let x=n.indexOf(",")>-1?",":" ";n=n.substr(4).split(")")[0].split(x);let f=(+n[0]).toString(16),m=(+n[1]).toString(16),o=(+n[2]).toString(16);return f.length===1&&(f="0"+f),m.length===1&&(m="0"+m),o.length===1&&(o="0"+o),[f|0,m|0,o|0]}function H(n,x){let f=1/0,m=null,[o,O,A]=n;return x.forEach(L=>{let[w,d,b]=L.startsWith("#")?Y(L):Q(L),_=Math.sqrt((o-w)**2+(O-d)**2+(A-b)**2);_<f&&(f=_,m=L)}),m}function u(n,x,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.script={},{loadScript:async(m,o)=>{let{baseURL:O,ignoreErrors:A,crossOrigin:L}=f,w=et(m);m=nt(m,O);let d=document.createElement("script"),b={asset:d,type:"script",src:m,id:w};return new Promise(_=>{z(n,1),d.crossOrigin=L,d.onerror=F=>{if(console.error(F),!A)throw new Error("Failed to load "+m);o&&o(),n.emit("asset-error",b)},d.onload=()=>{n.ASSETS.script[w]=d,o&&o(d),n.emit("asset-load",b),z(n,-1),_(d)},n.emit("filter-asset",d,b),d.src=m,document.head.appendChild(d)})}}}function st(n,x,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.sound={},{loadSound:async(m,o)=>{let{crossOrigin:O,ignoreErrors:A,allowSoundInterruptions:L,baseURL:w}=f,d=et(m);m=nt(m,w);let b=new Audio,_={asset:b,type:"sound",src:m,id:d};return new Promise(F=>{z(n,1),b.crossOrigin=O,b.onerror=V=>{if(console.error(V),!A)throw new Error("Failed to load "+m);o&&o(null),n.emit("asset-error",_)},b[L?"oncanplay":"oncanplaythrough"]=()=>{n.ASSETS.sound[d]=b,o&&o(b),n.emit("asset-load",_),z(n,-1),F(b)},n.emit("filter-asset",b,_),b.src=m})}}}Object.assign(HTMLAudioElement.prototype,{stop(){this.pause(),this.currentTime=0,this.src=this.src},restart(){this.pause(),this.currentTime=0,this.play()}});function B(n,x,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.json={},{loadJSON:async(m,o,O)=>{let{baseURL:A,ignoreErrors:L}=f,w=et(m);m=nt(m,A);let d={type:"json",src:m,id:w};n.emit("filter-asset",null,d),z(n,1),n.ASSETS.json={};let b=fetch(m,O);return b.then(_=>_.json()).then(_=>{ASSETS.json[w]=_,d.json=_,o&&o(_),n.emit("asset-load",d),z(n,-1)}).catch(_=>{if(console.error(_),!L)throw new Error("Failed to load JSON from "+m);o&&o(),n.emit("asset-error",d)}),b}}}function P(n){return{load:x=>new Promise((f,m)=>{z(n,1),x(o=>(z(n,-1),f(o)),m)})}}function E(n,x,f={}){n.use(D,f),n.use(I,f),n.use(u,f),n.use(st,f),n.use(B,f),n.use(P)}window.pluginAssetLoader=E})();})();
/*! @litecanvas/utils by Luiz Bills | MIT Licensed */
/*! Asset Loader plugin for litecanvas by Luiz Bills | MIT Licensed */
