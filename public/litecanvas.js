(()=>{(()=>{var et=new AudioContext,it=(D=1,M=.05,N=220,Y=0,z=0,Q=.1,L=0,u=1,st=0,V=0,H=0,E=0,n=0,T=0,f=0,p=0,o=0,I=1,A=0,C=0,x=0)=>{let b=Math,d=2*b.PI,y=44100,U=st*=500*d/y/y,W=N*=(1-M+2*M*b.random(M=[]))*d/y,F=0,X=0,P=0,m=1,dt=0,ut=0,q=0,G=x<0?-1:1,rt=d*G*x*2/y,lt=b.cos(rt),r=b.sin,s=r(rt)/4,h=1+s,c=-2*lt/h,g=(1-s)/h,v=(1+G*lt)/2/h,j=-(G+lt)/h,J=v,w=0,O=0,S=0,k=0;for(Y=y*Y+9,A*=y,z*=y,Q*=y,o*=y,V*=500*d/y**3,f*=d/y,H*=d/y,E*=y,n=y*n|0,D*=.3*(globalThis.zzfxV||1),G=Y+A+z+Q+o|0;P<G;M[P++]=q*D)++ut%(100*p|0)||(q=L?1<L?2<L?3<L?r(F*F):b.max(b.min(b.tan(F),1),-1):1-(2*F/d%2+2)%2:1-4*b.abs(b.round(F/d)-F/d):r(F),q=(n?1-C+C*r(d*P/n):1)*(q<0?-1:1)*b.abs(q)**u*(P<Y?P/Y:P<Y+A?1-(P-Y)/A*(1-I):P<Y+A+z?I:P<G-o?(G-P-o)/Q*I:0),q=o?q/2+(o>P?0:(P<G-o?1:(G-P)/o)*M[P-o|0]/2/D):q,x&&(q=k=J*w+j*(w=O)+v*(O=q)-g*S-c*(S=k))),rt=(N+=st+=V)*b.cos(f*X++),F+=rt+rt*T*r(P**5),m&&++m>E&&(N+=H,W+=H,m=0),!n||++dt%n||(N=W,st=U,m=m||1);D=et.createBuffer(1,G,y),D.getChannelData(0).set(M),N=et.createBufferSource(),N.buffer=D,N.connect(et.destination),N.start()},ht=["#111","#6a7799","#aec2c2","#FFF1E8","#e83b3b","#fabc20","#155fd9","#3cbcfc","#327345","#63c64d","#6c2c1f","#ac7c00"],i=(D,M="Assertion failed")=>{if(!D)throw new Error(M)};function B(D={}){let M=globalThis,N=Math.PI,Y=N*2,z=requestAnimationFrame,Q=[],L=(r,s,h)=>{r.addEventListener(s,h,!1),Q.push(()=>r.removeEventListener(s,h,!1))},u=Number.isFinite;D=Object.assign({fullscreen:!0,width:null,height:null,autoscale:!0,pixelart:!1,antialias:!1,canvas:null,global:!0,loop:null,pauseOnBlur:!0,tapEvents:!0,keyboardEvents:!0,animate:!0},D);let V=!1,H=[],E=D.canvas||document.createElement("canvas"),n=D.fullscreen,T=D.autoscale,f=D.animate,p=1,o,I=.5,A=1,C,x,b,d=!0,y="sans-serif",U=32,W=Date.now(),F=D.global,X={init:null,update:null,draw:null,resized:null,tap:null,untap:null,tapping:null,tapped:null},P={settings:Object.assign({},D),colors:ht},m={WIDTH:D.width,HEIGHT:D.height||D.width,CANVAS:null,ELAPSED:0,CENTERX:0,CENTERY:0,MOUSEX:-1,MOUSEY:-1,DEFAULT_SFX:[.5,,1675,,.06,.2,1,1.8,,,637,.06],PI:N,TWO_PI:Y,HALF_PI:N*.5,lerp:(r,s,h)=>(i(u(r),"lerp: 1st param must be a number"),i(u(s),"lerp: 2nd param must be a number"),i(u(h),"lerp: 3rd param must be a number"),r+h*(s-r)),deg2rad:r=>(i(u(r),"deg2rad: 1st param must be a number"),N/180*r),rad2deg:r=>(i(u(r),"rad2deg: 1st param must be a number"),180/N*r),clamp:(r,s,h)=>(i(u(r),"clamp: 1st param must be a number"),i(u(s),"clamp: 2nd param must be a number"),i(u(h),"clamp: 3rd param must be a number"),i(h>s,"randi: the 2nd param must be less than the 3rd param"),r<s?s:r>h?h:r),wrap:(r,s,h)=>(i(u(r),"wrap: 1st param must be a number"),i(u(s),"wrap: 2nd param must be a number"),i(u(h),"wrap: 3rd param must be a number"),i(h>s,"randi: the 2nd param must be less than the 3rd param"),i(h!==s,"randi: the 2nd param must be not equal to the 3rd param"),r-(h-s)*Math.floor((r-s)/(h-s))),map(r,s,h,c,g,v){i(u(r),"map: 1st param must be a number"),i(u(s),"map: 2nd param must be a number"),i(u(h),"map: 3rd param must be a number"),i(u(c),"map: 4th param must be a number"),i(u(g),"map: 5th param must be a number");let j=(r-s)/(h-s)*(g-c)+c;return v?m.clamp(j,c,g):j},norm:(r,s,h)=>(i(u(r),"norm: 1st param must be a number"),i(u(s),"norm: 2nd param must be a number"),i(u(h),"norm: 3rd param must be a number"),m.map(r,s,h,0,1)),rand:(r=0,s=1)=>{i(u(r),"rand: 1st param must be a number"),i(u(s),"rand: 2nd param must be a number"),i(s>r,"rand: the 1st param must be less than the 2nd param");let h=1664525,c=1013904223,g=4294967296;return W=(h*W+c)%g,W/g*(s-r)+r},randi:(r=0,s=1)=>(i(u(r),"randi: 1st param must be a number"),i(u(s),"randi: 2nd param must be a number"),i(s>r,"randi: the 1st param must be less than the 2nd param"),Math.floor(m.rand(r,s+1))),seed:r=>(i(r==null||u(r)&&r>=0,"seed: 1st param must be a positive number or zero"),r==null?W:W=~~r),cls(r){i(r==null||u(r)&&r>=0,"cls: 1st param must be a number");let s=o.canvas.width,h=o.canvas.height;r==null?o.clearRect(0,0,s,h):m.rectfill(0,0,s,h,r)},rect(r,s,h,c,g,v=null){i(u(r),"rect: 1st param must be a number"),i(u(s),"rect: 2nd param must be a number"),i(u(h)&&h>0,"rect: 3rd param must be a positive number"),i(u(c)&&c>=0,"rect: 4th param must be a positive number or zero"),i(g==null||u(g)&&g>=0,"rect: 5th param must be a positive number or zero"),i(v==null||u(v)||Array.isArray(v)&&v.length>=1,"rect: 6th param must be a number or array of numbers"),o.beginPath(),o[v?"roundRect":"rect"](~~r-I,~~s-I,~~h+I*2,~~c+I*2,v),m.stroke(g)},rectfill(r,s,h,c,g,v=null){i(u(r),"rectfill: 1st param must be a number"),i(u(s),"rectfill: 2nd param must be a number"),i(u(h)&&h>=0,"rectfill: 3rd param must be a positive number or zero"),i(u(c)&&c>=0,"rectfill: 4th param must be a positive number or zero"),i(g==null||u(g)&&g>=0,"rectfill: 5th param must be a positive number or zero"),i(v==null||u(v)||Array.isArray(v)&&v.length>=1,"rectfill: 6th param must be a number or array of at least 2 numbers"),o.beginPath(),o[v?"roundRect":"rect"](~~r,~~s,~~h,~~c,v),m.fill(g)},circ(r,s,h,c){i(u(r),"circ: 1st param must be a number"),i(u(s),"circ: 2nd param must be a number"),i(u(h)&&h>=0,"circ: 3rd param must be a positive number or zero"),i(c==null||u(c)&&c>=0,"circ: 4th param must be a positive number or zero"),o.beginPath(),o.arc(~~r,~~s,~~h,0,Y),m.stroke(c)},circfill(r,s,h,c){i(u(r),"circfill: 1st param must be a number"),i(u(s),"circfill: 2nd param must be a number"),i(u(h)&&h>=0,"circfill: 3rd param must be a positive number or zero"),i(c==null||u(c)&&c>=0,"circfill: 4th param must be a positive number or zero"),o.beginPath(),o.arc(~~r,~~s,~~h,0,Y),m.fill(c)},line(r,s,h,c,g){i(u(r),"line: 1st param must be a number"),i(u(s),"line: 2nd param must be a number"),i(u(h),"line: 3rd param must be a positive number or zero"),i(u(c),"line: 4th param must be a positive number or zero"),i(g==null||u(g)&&g>=0,"line: 5th param must be a positive number or zero"),o.beginPath();let v=I!==0&&~~r===~~h?.5:0,j=I!==0&&~~s===~~c?.5:0;o.moveTo(~~r+v,~~s+j),o.lineTo(~~h+v,~~c+j),m.stroke(g)},linewidth(r){i(u(r)&&~~r>0,"linewidth: 1st param must be a positive number"),o.lineWidth=~~r,I=~~r%2===0?0:.5},linedash(r,s=0){i(Array.isArray(r)&&r.length>0,"linedash: 1st param must be an array of numbers"),i(u(s),"linedash: 2nd param must be a number"),o.setLineDash(r),o.lineDashOffset=s},text(r,s,h,c=3,g="normal"){i(u(r),"text: 1st param must be a number"),i(u(s),"text: 2nd param must be a number"),i(c==null||u(c)&&c>=0,"text: 4th param must be a positive number or zero"),i(typeof g=="string","text: 5th param must be a string"),o.font=`${g} ${U}px ${y}`,o.fillStyle=m.getcolor(c),o.fillText(h,~~r,~~s)},textfont(r){i(typeof r=="string","textfont: 1st param must be a string"),y=r},textsize(r){i(u(r),"textsize: 1st param must be a number"),U=r},textalign(r,s){i(r==null||typeof r=="string","textalign: 1st param must be a string"),i(s==null||typeof s=="string","textalign: 2nd param must be a string"),r&&(o.textAlign=r),s&&(o.textBaseline=s)},image(r,s,h){i(u(r),"image: 1st param must be a number"),i(u(s),"image: 2nd param must be a number"),o.drawImage(h,~~r,~~s)},paint(r,s,h,c={}){i(u(r),"paint: 1st param must be a number"),i(u(s),"paint: 2nd param must be a number"),i(typeof h=="function"||Array.isArray(h),"paint: 3rd param must be a function or array"),i(c&&!c.scale||u(c.scale),"paint: 4th param (options.scale) must be a number");let g=c.canvas||new OffscreenCanvas(1,1),v=c.scale||1,j=o;if(g.width=r*v,g.height=s*v,o=g.getContext("2d"),o.scale(v,v),h.push){let J=0,w=0;o.imageSmoothingEnabled=!1;for(let O of h){for(let S of O)S!==" "&&S!=="."&&m.rectfill(J,w,1,1,parseInt(S,16)),J++;w++,J=0}}else h(o);return o=j,g},ctx(r){return r&&(o=r),o},push:()=>o.save(),pop:()=>o.restore(),translate:(r,s)=>(i(u(r),"translate: 1st param must be a number"),i(u(s),"translate: 2nd param must be a number"),o.translate(~~r,~~s)),scale:(r,s)=>(i(u(r),"scale: 1st param must be a number"),i(s==null||u(s),"scale: 2nd param must be a number"),o.scale(r,s||r)),rotate:r=>(i(u(r),"rotate: 1st param must be a number"),o.rotate(r)),alpha(r){i(u(r),"alpha: 1st param must be a number"),o.globalAlpha=m.clamp(r,0,1)},path:r=>(i(r==null||typeof r=="string"||r instanceof Path2D,"path: 1st param must be a string or a Path2D instance"),new Path2D(r)),fill(r,s){i(r==null||u(r)&&r>=0,"fill: 1st param must be a positive number or zero"),i(s==null||s instanceof Path2D,"fill: 2nd param must be a Path2D instance"),o.fillStyle=m.getcolor(r),s?o.fill(s):o.fill()},stroke(r,s){i(r==null||u(r)&&r>=0,"stroke: 1st param must be a positive number or zero"),i(s==null||s instanceof Path2D,"stroke: 2nd param must be a Path2D instance"),o.strokeStyle=m.getcolor(r),s?o.stroke(s):o.stroke()},clip(r){i(r instanceof Path2D,"clip: 1st param must be a Path2D instance"),o.clip(r)},sfx(r,s=0,h=1){return i(r==null||Array.isArray(r),"sfx: 1st param must be an array"),i(u(s),"sfx: 2nd param must be a number"),i(u(h),"sfx: 3rd param must be a number"),M.zzfxV<=0||navigator.userActivation&&!navigator.userActivation.hasBeenActive?!1:(r=r||m.DEFAULT_SFX,(s>0||h!==1)&&(r=r.slice(),r[0]=h*(r[0]||1),r[10]=~~r[10]+s),it.apply(0,r),r)},volume(r){i(u(r),"volume: 1st param must be a number"),M.zzfxV=r},colrect:(r,s,h,c,g,v,j,J)=>(i(u(r),"colrect: 1st param must be a number"),i(u(s),"colrect: 2nd param must be a number"),i(u(h),"colrect: 3rd param must be a number"),i(u(c),"colrect: 4th param must be a number"),i(u(g),"colrect: 5th param must be a number"),i(u(v),"colrect: 6th param must be a number"),i(u(j),"colrect: 7th param must be a number"),i(u(J),"colrect: 8th param must be a number"),r<g+j&&r+h>g&&s<v+J&&s+c>v),colcirc:(r,s,h,c,g,v)=>(i(u(r),"colcirc: 1st param must be a number"),i(u(s),"colcirc: 2nd param must be a number"),i(u(h),"colcirc: 3rd param must be a number"),i(u(c),"colcirc: 4th param must be a number"),i(u(g),"colcirc: 5th param must be a number"),i(u(v),"colcirc: 6th param must be a number"),(c-r)**2+(g-s)**2<=(h+v)**2),use(r,s={}){i(typeof r=="function","use: 1st param must be a function"),i(typeof s=="object","use: 2nd param must be an object"),V?lt(r,s):H.push([r,s])},listen(r,s){return i(typeof r=="string","listen: 1st param must be a string"),i(typeof s=="function","listen: 2nd param must be a function"),X[r]=X[r]||new Set,X[r].add(s),()=>X[r].delete(s)},emit(r,s,h,c,g){i(typeof r=="string","emit: 1st param must be a string"),rt("before:"+r,s,h,c,g),rt(r,s,h,c,g),rt("after:"+r,s,h,c,g)},getcolor:r=>(i(r==null||u(r)&&r>=0,"getcolor: 1st param must be a number"),ht[~~r%ht.length]),setvar(r,s){i(typeof r=="string","setvar: 1st param must be a string"),s==null&&console.warn(`setvar: key "${r}" was defined as ${s}`),m[r]=s,F&&(M[r]=s)},resize(r,s){i(u(r),"resize: 1st param must be a number"),i(u(s),"resize: 2nd param must be a number"),m.setvar("WIDTH",E.width=r),m.setvar("HEIGHT",E.height=s),G()},timescale(r){i(u(r),"timescale: 1st param must be a number"),A=r},setfps(r){i(u(r)&&r>=1,"setfps: 1st param must be a positive number"),x=1/~~r,b=0},quit(){m.emit("quit");for(let r of Q)r();if(d=X=!1,F){for(let r in m)delete M[r];delete M.__litecanvas}}};for(let r of["sin","cos","atan2","hypot","tan","abs","ceil","round","floor","trunc","min","max","pow","sqrt","sign","exp"])m[r]=Math[r];function dt(){V=!0;let r=D.loop?D.loop:M;for(let s in X)r[s]&&m.listen(s,r[s]);for(let[s,h]of H)lt(s,h);if((n||T)&&L(M,"resize",G),G(),D.tapEvents){let s=(w,O)=>[(w-E.offsetLeft)/p,(O-E.offsetTop)/p],h=new Map,c=(w,O,S)=>{let k={x:O,y:S,startX:O,startY:S,ts:performance.now()};return h.set(w,k),k},g=(w,O,S)=>{let k=h.get(w)||c(w);k.x=O,k.y=S},v=w=>w&&performance.now()-w.ts<=200,j=!1;L(E,"mousedown",w=>{w.preventDefault();let[O,S]=s(w.pageX,w.pageY);m.emit("tap",O,S,0),c(0,O,S),j=!0}),L(E,"mousemove",w=>{w.preventDefault();let[O,S]=s(w.pageX,w.pageY);m.setvar("MOUSEX",O),m.setvar("MOUSEY",S),j&&(m.emit("tapping",O,S,0),g(0,O,S))}),L(E,"mouseup",w=>{w.preventDefault();let O=h.get(0),[S,k]=s(w.pageX,w.pageY);v(O)&&m.emit("tapped",O.startX,O.startY,0),m.emit("untap",S,k,0),h.delete(0),j=!1}),L(E,"touchstart",w=>{w.preventDefault();let O=w.changedTouches;for(let S of O){let[k,ft]=s(S.pageX,S.pageY);m.emit("tap",k,ft,S.identifier+1),c(S.identifier+1,k,ft)}}),L(E,"touchmove",w=>{w.preventDefault();let O=w.changedTouches;for(let S of O){let[k,ft]=s(S.pageX,S.pageY);m.emit("tapping",k,ft,S.identifier+1),g(S.identifier+1,k,ft)}});let J=w=>{w.preventDefault();let O=[];if(w.targetTouches.length>0)for(let S of w.targetTouches)O.push(S.identifier+1);for(let[S,k]of h)O.includes(S)||(v(k)&&m.emit("tapped",k.startX,k.startY,S),m.emit("untap",k.x,k.y,S),h.delete(S))};L(E,"touchend",J),L(E,"touchcancel",J),L(M,"blur",()=>{j=!1;for(let[w,O]of h)m.emit("untap",O.x,O.y,w),h.delete(w)})}if(D.keyboardEvents){let s=new Set,h=c=>(i(typeof c=="string","iskeydown: 1st param must be a string"),c==="any"?s.size>0:s.has(c.toLowerCase()));m.setvar("iskeydown",h),L(M,"keydown",c=>{s.add(c.key.toLowerCase())}),L(M,"keyup",c=>{s.delete(c.key.toLowerCase())}),L(M,"blur",()=>s.clear())}D.pauseOnBlur&&(L(M,"blur",()=>{d=!1}),L(M,"focus",()=>{d=!0,z(ut)})),m.setfps(60),m.emit("init",m),C=performance.now(),z(ut)}function ut(r){let s=!f,h=(r-C)/1e3,c=x*5;for(b+=h>c?c:h,C=r;b>=x;)m.emit("update",x*A),m.setvar("ELAPSED",m.ELAPSED+x*A),b-=x,s=!0;s&&(m.textalign("start","top"),m.emit("draw")),d&&f&&z(ut)}function q(){E=typeof E=="string"?document.querySelector(E):E,m.setvar("CANVAS",E),o=E.getContext("2d"),L(E,"click",()=>M.focus()),m.WIDTH>0&&(n=!1),E.style="",E.width=m.WIDTH,E.height=m.HEIGHT||m.WIDTH,E.parentNode||document.body.appendChild(E)}function G(){let r=M.innerWidth,s=M.innerHeight,h=E.style;h.display="block",n?(h.position="absolute",h.inset=0,m.setvar("WIDTH",E.width=r),m.setvar("HEIGHT",E.height=s)):T&&(h.margin="auto",p=Math.min(r/m.WIDTH,s/m.HEIGHT),p=(D.pixelart?~~p:p)||1,h.width=m.WIDTH*p+"px",h.height=m.HEIGHT*p+"px"),m.setvar("CENTERX",m.WIDTH/2),m.setvar("CENTERY",m.HEIGHT/2),(!D.antialias||D.pixelart)&&(o.imageSmoothingEnabled=!1,E.style.imageRendering="pixelated"),m.emit("resized",p),f||z(ut)}function rt(r,s,h,c,g){if(X[r])for(let v of X[r])v(s,h,c,g)}function lt(r,s){let h=r(m,P,s);if(typeof h=="object")for(let c of Object.keys(h))m.setvar(c,h[c])}if(F){if(M.__litecanvas)throw"global litecanvas already instantiated";Object.assign(M,m),M.__litecanvas=m}return q(),document.readyState==="loading"?L(M,"DOMContentLoaded",()=>z(dt)):z(dt),m}globalThis.litecanvas=B})();(()=>{var et=Object.defineProperty,it=(t,e)=>{for(var a in e)et(t,a,{get:e[a],enumerable:!0})};globalThis.utils=globalThis.utils||{},globalThis.utils.global=()=>{for(let t in globalThis.utils)t!=="global"&&(globalThis[t]=globalThis.utils[t])};var ht={};it(ht,{ANCHOR_BOT_LEFT:()=>ft,ANCHOR_BOT_RIGHT:()=>Ot,ANCHOR_CENTER:()=>O,ANCHOR_TOP_LEFT:()=>S,ANCHOR_TOP_RIGHT:()=>k,Actor:()=>Dt,BACK_IN:()=>Nt,BACK_IN_OUT:()=>zt,BACK_OUT:()=>Yt,BOUNCE_IN:()=>vt,BOUNCE_IN_OUT:()=>Vt,BOUNCE_OUT:()=>xt,Camera:()=>D,DOWN:()=>J,EASE_IN:()=>Ft,EASE_IN_OUT:()=>jt,EASE_OUT:()=>Xt,ELASTIC_IN:()=>Wt,ELASTIC_IN_OUT:()=>Gt,ELASTIC_OUT:()=>Bt,Grid:()=>M,LEFT:()=>w,LINEAR:()=>wt,Noise:()=>Kt,ONE:()=>g,RIGHT:()=>j,TypedGrid:()=>N,UP:()=>v,Vector:()=>st,ZERO:()=>c,advance:()=>kt,diff:()=>Ct,flipImage:()=>Qt,fract:()=>Ht,intersection:()=>i,mod:()=>Rt,range:()=>Pt,resolve:()=>B,scaleImage:()=>Zt,tint:()=>Jt,tween:()=>Ut,vec:()=>H,vecAbs:()=>q,vecAdd:()=>T,vecAngle:()=>F,vecAngleBetween:()=>X,vecCeil:()=>G,vecClamp:()=>r,vecCross:()=>m,vecDist:()=>U,vecDist2:()=>W,vecDiv:()=>o,vecDot:()=>P,vecEq:()=>E,vecFloor:()=>rt,vecIsZero:()=>h,vecLerp:()=>dt,vecLimit:()=>y,vecMag:()=>x,vecMag2:()=>b,vecMove:()=>s,vecMult:()=>p,vecNorm:()=>d,vecRand:()=>ut,vecReflect:()=>A,vecRotate:()=>I,vecRound:()=>lt,vecSet:()=>n,vecSetMag:()=>C,vecSub:()=>f,wave:()=>Lt});var i=(t,e,a,l,_,R,$,Z)=>{let at=Math.max(t,_),ct=Math.min(t+a,_+$)-at,mt=Math.max(e,R),bt=Math.min(e+l,R+Z)-mt;return[at,mt,ct,bt]},B=(t,e,a,l,_,R,$,Z)=>{let[at,ct,mt,bt]=i(t,e,a,l,_,R,$,Z),pt="",tt=t,K=e;return mt<bt?t<_?(pt="right",tt=_-a):(pt="left",tt=_+$):e<R?(pt="bottom",K=R-l):(pt="top",K=R+Z),{direction:pt,x:tt,y:K}},D=class{_engine=null;x=0;y=0;ox=0;oy=0;width=0;height=0;rotation=0;scale=1;_shake={x:0,y:0,removeListener:null};constructor(t=null,e=0,a=0,l=null,_=null){this._engine=t||globalThis,this.ox=e,this.oy=a,this.resize(l||this._engine.WIDTH-e,_||this._engine.HEIGHT-a),this.x=this.width/2,this.y=this.height/2}resize(t,e){this.width=t,this.height=e,this._engine.emit("camera-resized",this)}start(t=!1){if(this._engine.push(),t){let l=path();l.rect(this.ox,this.oy,this.width,this.height),this._engine.clip(l)}let e=this.ox+this.width/2,a=this.oy+this.height/2;this._engine.translate(e,a),this._engine.scale(this.scale),this._engine.rotate(this.rotation),this._engine.translate(-this.x+this._shake.x,-this.y+this._shake.y)}end(){this._engine.pop()}lookAt(t,e){this.x=t,this.y=e}move(t,e){this.x+=t,this.y+=e}zoom(t){this.scale*=t}zoomTo(t){this.scale=t}rotate(t){this.rotation+=t}rotateTo(t){this.rotation=t}getWorldPoint(t,e,a={}){let l=Math.cos(-this.rotation),_=Math.sin(-this.rotation);return t=(t-this.width/2-this.ox)/this.scale,e=(e-this.height/2-this.oy)/this.scale,a.x=l*t-_*e+this.x,a.y=_*t+l*e+this.y,a}getCameraPoint(t,e,a={}){let l=Math.cos(-this.rotation),_=Math.sin(-this.rotation);return t=t-this.x,e=e-this.y,t=l*t-_*e,e=_*t+l*e,a.x=t*this.scale+this.width/2+this.ox,a.y=e*this.scale+this.height/2+this.oy,a}getBounds(){return[this.ox,this.oy,this.width,this.height]}viewing(t,e,a,l){let _=this.width/2-this.x,R=this.height/2-this.y,$=this.width/this.scale,Z=this.height/this.scale;return this._engine.colrect(t,e,a,l,_,R,$,Z)}shake(t=1,e=.3){this.shaking||(this._shake.removeListener=this._engine.listen("update",a=>{this._shake.x=this._engine.randi(-t,t),this._shake.y=this._engine.randi(-t,t),e-=a,e<=0&&this.unshake()}))}unshake(){this.shaking&&(this._shake.removeListener(),this._shake.removeListener=null,this._shake.x=this._shake.y=0)}get shaking(){return this._shake.removeListener!==null}},M=class Mt{_w;_h;_c;constructor(e,a,l=[]){this._w=Math.max(1,~~e),this._h=Math.max(1,~~a),this._c=l}[Symbol.iterator](){let e=0;return{next:()=>({value:[this.indexToPointX(e),this.indexToPointY(e),this._c[e++]],done:e>this._c.length})}}clone(){return new Mt(this._w,this._h,this._c)}clear(){this.forEach((e,a)=>this.set(e,a,void 0))}get width(){return this._w}get height(){return this._h}set(e,a,l){this._c[this.pointToIndex(e,a)]=l}get(e,a){return this._c[this.pointToIndex(e,a)]}has(e,a){return this.get(e,a)!=null}check(e,a){return e>=0&&e<this._w&&a>=0&&a<this._h}get length(){return this._w*this._h}pointToIndex(e,a){return this.clampX(~~e)+this.clampY(~~a)*this._w}indexToPointX(e){return e%this._w}indexToPointY(e){return Math.floor(e/this._w)}forEach(e,a=!1){let l=a?this.length-1:0,_=a?-1:this.length,R=a?-1:1;for(;l!==_;){let $=this.indexToPointX(l),Z=this.indexToPointY(l),at=this._c[l];if(e($,Z,at,this)===!1)break;l+=R}}fill(e){this.forEach((a,l)=>{this.set(a,l,e)})}clampX(e){return Y(e,0,this._w-1)}clampY(e){return Y(e,0,this._h-1)}toArray(){return this._c.slice()}toString(e=" ",a=!0){if(!a)return this._c.join(e);let l=[];return this.forEach((_,R,$)=>{l[R]=l[R]||"",l[R]+=$+e}),l.join(`
`)}},N=class It extends M{constructor(e,a,l=Uint8Array){super(e,a,null),this._c=new l(this._w*this._h)}has(e,a){return this.get(e,a)!==0}clone(){let e=new It(this._w,this._h,this._c.constructor);return this.forEach((a,l,_)=>{e.set(a,l,_)}),e}};function Y(t,e,a){return t<e?e:t>a?a:t}var z=Math.sqrt,Q=Math.cos,L=Math.sin,u=2*Math.PI,st=class{x;y;constructor(t=0,e=t){this.x=t,this.y=e}toString(){return`Vector (${this.x}, ${this.y})`}},V=t=>t instanceof st,H=(t=0,e=t)=>(V(t)&&(e=t.y,t=t.x),new st(t,e)),E=(t,e,a=e)=>V(e)?E(t,e.x,e.y):t.x===e&&t.y===a,n=(t,e,a=e)=>(V(e)?n(t,e.x,e.y):(t.x=e,t.y=a),t),T=(t,e,a=e)=>V(e)?T(t,e.x,e.y):(t.x+=e,t.y+=a,t),f=(t,e,a=e)=>V(e)?f(t,e.x,e.y):(t.x-=e,t.y-=a,t),p=(t,e,a=e)=>V(e)?p(t,e.x,e.y):(t.x*=e,t.y*=a,t),o=(t,e,a=e)=>V(e)?o(t,e.x,e.y):(t.x/=e||1,t.y/=a||1,t),I=(t,e)=>{let a=Q(e),l=L(e);return t.x=a*t.x-l*t.y,t.y=l*t.x+a*t.y,t},A=(t,e)=>{let a=d(H(e));return f(t,p(a,2*P(t,a)))},C=(t,e)=>(d(t),p(t,e),t),x=t=>z(t.x*t.x+t.y*t.y),b=t=>t.x*t.x+t.y*t.y,d=t=>{let e=x(t);return e>0&&o(t,e),t},y=(t,e=1)=>{let a=b(t);return a>e*e&&(o(t,z(a)),p(t,e)),t},U=(t,e)=>{let a=t.x-e.x,l=t.y-e.y;return z(a*a+l*l)},W=(t,e)=>{let a=t.x-e.x,l=t.y-e.y;return a*a+l*l},F=t=>Math.atan2(t.y,t.x),X=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),P=(t,e)=>t.x*e.x+t.y*e.y,m=(t,e)=>t.x*e.y-t.y*e.x,dt=(t,e,a)=>(t.x+=(e.x-t.x)*a||0,t.y+=(e.y-t.y)*a||0,t),ut=(t=1,e=t,a=globalThis.rand||Math.random)=>{let l=a()*u,_=a()*(e-t)+t;return H(Q(l)*_,L(l)*_)},q=t=>(t.x=Math.abs(t.x),t.y=Math.abs(t.y),t),G=t=>(t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t),rt=t=>(t.x=Math.floor(t.x),t.y=Math.floor(t.y),t),lt=t=>(t.x=Math.round(t.x),t.y=Math.round(t.y),t),r=(t,e,a)=>(t.x<e.x&&(t.x=e.x),t.x>a.x&&(t.x=a.x),t.y<e.y&&(t.y=e.y),t.y>a.y&&(t.y=a.y),t),s=(t,e,a=1)=>T(t,e.x*a,e.y*a),h=t=>E(t,c),c=H(0,0),g=H(1,1),v=H(0,-1),j=H(1,0),J=H(0,1),w=H(-1,0),O=H(.5,.5),S=H(0,0),k=H(1,0),ft=H(0,1),Ot=H(1,1),Dt=class{sprite;pos;_o;_s;flipX=!1;flipY=!1;angle=0;opacity=1;hidden=!1;constructor(t,e,a=S){this.sprite=t,this.pos=e||H(0),this._o=H(a),this._s=H(1,1)}set x(t){this.pos.x=t}get x(){return this.pos.x}set y(t){this.pos.y=t}get y(){return this.pos.y}set anchor(t){this._o.x=t.x,this._o.y=t.y}get anchor(){return this._o}get width(){return this.sprite.width*this._s.x}get height(){return this.sprite.height*this._s.y}get scale(){return this._s}scaleTo(t,e=t){this._s.x=t,this._s.y=e}scaleBy(t,e=t){this._s.x*=t,this._s.y*=e}getBounds(t=!0){let e=this.sprite.width*(t?this._s.x:1),a=this.sprite.height*(t?this._s.y:1),l=this.pos.x-e*this.anchor.x,_=this.pos.y-a*this.anchor.y;return[l,_,e,a]}draw(t=globalThis,e=!0){this.hidden||this.opacity<=0||(e&&t.push(),this.transform(t),this.drawImage(t),e&&t.pop())}transform(t){t.translate(this.pos.x,this.pos.y),t.rotate(t.deg2rad(this.angle)),t.scale((this.flipX?-1:1)*this._s.x,(this.flipY?-1:1)*this._s.y)}drawImage(t,e=!0){let a=this.anchor,l=-this.sprite.width*(this.flipX?1-a.x:a.x),_=-this.sprite.height*(this.flipY?1-a.y:a.y);e&&t.alpha(this.opacity),t.image(l,_,this.sprite)}},Ct=(t,e)=>Math.abs(e-t)||0,Lt=(t,e,a,l=Math.sin)=>t+(l(a)+1)/2*(e-t),Ht=t=>t%1||0,Pt=t=>Array.from(Array(t).keys()),kt=advance=(t,e,a,l=1)=>{a&&(e.x+=a.x*l,e.y+=a.y*l),t.x+=e.x*l,t.y+=e.y*l},Rt=(t,e)=>(e+t%e)%e,gt=Math.PI/2,Ut=(t,e,a,l=1,_=wt)=>new $t(t,e,a,l,_),wt=t=>t,Ft=t=>t*t,Xt=t=>-t*(t-2),jt=t=>t<.5?2*t*t:-2*t*t+4*t-1,Nt=t=>t*t*t-t*Math.sin(t*Math.PI),Yt=t=>{let e=1-t;return 1-(e*e*e-e*Math.sin(e*Math.PI))},zt=t=>{if(t<.5){let a=2*t;return .5*(a*a*a-a*Math.sin(a*Math.PI))}let e=1-(2*t-1);return .5*(1-(e*e*e-e*Math.sin(t*Math.PI)))+.5},Wt=t=>Math.sin(13*gt*t)*Math.pow(2,10*(t-1)),Bt=t=>Math.sin(-13*gt*(t+1))*Math.pow(2,-10*t)+1,Gt=t=>{if(t<.5){let l=Math.sin(13*gt*(2*t)),_=Math.pow(2,10*(2*t-1));return .5*l*_}let e=Math.sin(-13*gt*(2*t-1+1)),a=Math.pow(2,-10*(2*t-1));return .5*(e*a+2)},vt=t=>1-xt(1-t),xt=t=>t<4/11?121*t*t/16:t<8/11?363/40*t*t-99/10*t+17/5:t<9/10?4356/361*t*t-35442/1805*t+16061/1805:54/5*t*t-513/25*t+268/25,Vt=t=>t<.5?.5*vt(t*2):.5*xt(t*2-1)+.5,$t=class{running=!1;_o;_p;_x;_d;_w;_e;_rel;_cb=[];_t=0;_u=0;_ch=this;_cu=this;_lc;constructor(t,e,a,l,_){this._o=t,this._p=e,this._x=a,this._d=l,this._e=_,this._w=0}start(t){if(this.running)return this;this._cu.stop(!1),this._ch=this._cu=this,this.running=!0;let e=this._o[this._p]||0,a=this._rel?e+this._x:this._x;return this._lc=this._lc||t||globalThis,this._u=this._lc.listen("update",l=>{if(this._t<=this._w){this._t+=l;return}let _=this._t-this._w;this._o[this._p]=this._lc.lerp(e,a,this._e(_/this._d)),this._t+=l,_>=this._d&&(this._o[this._p]=a,this.stop())}),this}stop(t=!0){if(!this._u)return this;if(this.running=!1,this._u(),this._t=0,t)for(let e of this._cb)e(this._o);return this}restart(t=null,e=!1){return this.stop(e).restart(t)}onEnd(t){return this._cb.push(t),this}chain(t){return this._ch.onEnd(()=>{this._cu=t.start(this._lc)}),this._ch=t,this}reset(){return this._cb.length=0,this.stop()}relative(t=!0){return this._rel=t,this}delay(t){return this._w=t,this}get current(){return this._cu}get progress(){return this.running&&this._t>this._w?(this._t-this._w)/this._d:0}},St=4,_t=1<<St,Et=8,qt=1<<Et,nt=4095,Tt=t=>.5*(1-Math.cos(t*Math.PI)),Kt=class{_p=[];_po=4;_pf=.5;_e=null;constructor(t){this._e=t||globalThis,this.noiseSeed()}noise(t,e=0,a=0){t<0&&(t=-t),e<0&&(e=-e),a<0&&(a=-a);let l=Math.floor(t),_=Math.floor(e),R=Math.floor(a),$=t-l,Z=e-_,at=a-R,ct,mt,bt=0,pt=.5,tt,K,yt;for(let At=0;At<this._po;At++){let ot=l+(_<<St)+(R<<Et);ct=Tt($),mt=Tt(Z),tt=this._p[ot&nt],tt+=ct*(this._p[ot+1&nt]-tt),K=this._p[ot+_t&nt],K+=ct*(this._p[ot+_t+1&nt]-K),tt+=mt*(K-tt),ot+=qt,K=this._p[ot&nt],K+=ct*(this._p[ot+1&nt]-K),yt=this._p[ot+_t&nt],yt+=ct*(this._p[ot+_t+1&nt]-yt),K+=mt*(yt-K),tt+=Tt(at)*(K-tt),bt+=tt*pt,pt*=this._pf,l<<=1,$*=2,_<<=1,Z*=2,R<<=1,at*=2,$>=1&&(l++,$--),Z>=1&&(_++,Z--),at>=1&&(R++,at--)}return bt}noiseDetail(t,e){t>0&&(this._po=t),e>0&&(this._pf=e)}noiseSeed(t=null){t!=null&&this._e.seed(t);let e=this._e.rand||Math.random;for(let a=0;a<nt+1;a++)this._p[a]=e()}},Jt=(t,e,a=1,l=globalThis)=>l.paint(t.width,t.height,_=>{l.push(),l.alpha(a),l.rectfill(0,0,t.width,t.height,e),_.globalCompositeOperation="destination-atop",l.alpha(1),l.image(0,0,t),l.pop()}),Zt=(t,e,a=!0,l=globalThis)=>l.paint(t.width*e,t.height*e,_=>{l.push(),_.imageSmoothingEnabled=!a,l.scale(e),l.image(0,0,t),l.pop()}),Qt=(t,e=!0,a=!1,l=globalThis)=>l.paint(t.width,t.height,_=>{l.push(),l.scale(e?-1:1,a?-1:1),l.image(e?-t.width:0,a?-t.height:0,t),l.pop()});globalThis.utils=Object.assign(globalThis.utils||{},ht)})();(()=>{function et(n){return n.split("\\").pop().split("/").pop().split(".")[0]}function it(n,T){return T&&!ht(n)&&(n=T+n),n}function ht(n){try{return!!new URL(n).protocol}catch{}return!1}var i={crossOrigin:"anonymous",baseURL:null,allowSoundInterruptions:!0,ignoreErrors:!1},B=(n,T)=>{let f="LOADING";n.setvar(f,~~n[f]+~~T)};function D(n,T,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.font={},{loadFont:async(p,o,I)=>{let{baseURL:A,ignoreErrors:C}=f,x=et(o);o=it(o,A);let b=new FontFace(p,`url(${o})`),d={asset:b,type:"font",fontName:p,src:o,id:x};n.emit("filter-asset",b,d),document.fonts.add(b),B(n,1);let y=b.load();return y.then(U=>{ASSETS.font[x]=U,I&&I(U),n.emit("asset-load",d),B(n,-1)}).catch(U=>{if(console.error(U),!C)throw new Error("Failed to load font from "+o);I&&I(),n.emit("asset-error",d)}),y}}}function M(n,{colors:T},f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.image={},{loadImage:async(p,o)=>{let{baseURL:I,ignoreErrors:A,crossOrigin:C}=f,x={splitFrames:N,convertColors:Y(T)},b=et(p);p=it(p,I);let d=new Image,y={asset:d,type:"image",src:p,id:b};return new Promise(U=>{B(n,1),d.crossOrigin=C,d.onerror=W=>{console.error(W);let F="Failed to load image from "+p;if(!A)throw new Error(F);o&&o(),n.emit("asset-error",y)},d.onload=()=>{n.ASSETS.image[b]=d,o&&o(d,x),n.emit("asset-load",y),B(n,-1),U(d)},n.emit("filter-asset",d,y),d.src=p})}}}function N(n,T,f,p=0,o=0){let I=[],A=Math.floor((n.width+o)/(T+o)),C=Math.floor((n.height+o)/(f+o));for(let x=0;x<C;x++)for(let b=0;b<A;b++){let d=new OffscreenCanvas(T,f);d.getContext("2d").drawImage(n,p+b*T+b*o,p+x*f+x*o,T,f,0,0,T,f),I.push(d)}return I}function Y(n){return(T,f=!1)=>{let p=new OffscreenCanvas(T.width,T.height),o=p.getContext("2d");o.drawImage(T,0,0);let I=o.getImageData(0,0,T.width,T.height),A=I.data,C=new Map;for(let x=0,b=A.length;x<b;x+=4){let d=A[x],y=A[x+1],U=A[x+2],W=[d,y,U],F=W.join(","),X=C.get(F);X||(X=L(W,n),C.set(F,X));let P=X.startsWith("#")?z(X):Q(X);A[x]=P[0],A[x+1]=P[1],A[x+2]=P[2],A[x+3]=f?A[x+3]:255}return o.putImageData(I,0,0),p}}function z(n){let T=0,f=0,p=0;return n.length===4?(T="0x"+n[1]+n[1],f="0x"+n[2]+n[2],p="0x"+n[3]+n[3]):n.length===7&&(T="0x"+n[1]+n[2],f="0x"+n[3]+n[4],p="0x"+n[5]+n[6]),[~~T,~~f,~~p]}function Q(n){let T=n.indexOf(",")>-1?",":" ";n=n.substr(4).split(")")[0].split(T);let f=(+n[0]).toString(16),p=(+n[1]).toString(16),o=(+n[2]).toString(16);return f.length===1&&(f="0"+f),p.length===1&&(p="0"+p),o.length===1&&(o="0"+o),[f|0,p|0,o|0]}function L(n,T){let f=1/0,p=null,[o,I,A]=n;return T.forEach(C=>{let[x,b,d]=C.startsWith("#")?z(C):Q(C),y=Math.sqrt((o-x)**2+(I-b)**2+(A-d)**2);y<f&&(f=y,p=C)}),p}function u(n,T,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.script={},{loadScript:async(p,o)=>{let{baseURL:I,ignoreErrors:A,crossOrigin:C}=f,x=et(p);p=it(p,I);let b=document.createElement("script"),d={asset:b,type:"script",src:p,id:x};return new Promise(y=>{B(n,1),b.crossOrigin=C,b.onerror=U=>{if(console.error(U),!A)throw new Error("Failed to load "+p);o&&o(),n.emit("asset-error",d)},b.onload=()=>{n.ASSETS.script[x]=b,o&&o(b),n.emit("asset-load",d),B(n,-1),y(b)},n.emit("filter-asset",b,d),b.src=p,document.head.appendChild(b)})}}}function st(n,T,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.sound={},{loadSound:async(p,o)=>{let{crossOrigin:I,ignoreErrors:A,allowSoundInterruptions:C,baseURL:x}=f,b=et(p);p=it(p,x);let d=new Audio,y={asset:d,type:"sound",src:p,id:b};return new Promise(U=>{B(n,1),d.crossOrigin=I,d.onerror=W=>{if(console.error(W),!A)throw new Error("Failed to load "+p);o&&o(null),n.emit("asset-error",y)},d[C?"oncanplay":"oncanplaythrough"]=()=>{n.ASSETS.sound[b]=d,o&&o(d),n.emit("asset-load",y),B(n,-1),U(d)},n.emit("filter-asset",d,y),d.src=p})}}}Object.assign(HTMLAudioElement.prototype,{stop(){this.pause(),this.currentTime=0,this.src=this.src},restart(){this.pause(),this.currentTime=0,this.play()}});function V(n,T,f={}){return f=Object.assign({},i,f),n.setvar("ASSETS",n.ASSETS||{}),n.ASSETS.json={},{loadJSON:async(p,o,I)=>{let{baseURL:A,ignoreErrors:C}=f,x=et(p);p=it(p,A);let b={type:"json",src:p,id:x};n.emit("filter-asset",null,b),B(n,1),n.ASSETS.json={};let d=fetch(p,I);return d.then(y=>y.json()).then(y=>{ASSETS.json[x]=y,b.json=y,o&&o(y),n.emit("asset-load",b),B(n,-1)}).catch(y=>{if(console.error(y),!C)throw new Error("Failed to load JSON from "+p);o&&o(),n.emit("asset-error",b)}),d}}}function H(n){return{load:T=>new Promise((f,p)=>{B(n,1),T(o=>(B(n,-1),f(o)),p)})}}function E(n,T,f={}){n.use(D,f),n.use(M,f),n.use(u,f),n.use(st,f),n.use(V,f),n.use(H)}window.pluginAssetLoader=E})();})();
/*! @litecanvas/utils by Luiz Bills | MIT Licensed */
/*! Asset Loader plugin for litecanvas by Luiz Bills | MIT Licensed */
